import{k,u as O,d as m,e as w,l as x,r as S,o,c as i,a as e,j as C,w as _,v as f,t as p,f as u,i as v,b as V,g as T}from"./index-DwPljJjs.js";import{_ as P}from"./logo-Bn_1feJI.js";const R={class:"login-inner-card"},L=e("div",{class:"logo"},[e("img",{src:P,alt:""})],-1),E={class:"card"},N=e("div",{class:"login-heading"},[e("h3",null,"Sign In")],-1),D={class:"form-item mb-16"},U=e("div",{class:"title text-white"},"User Id",-1),A={key:0,class:"err-msg"},B={key:0,class:"form-item mb-16"},j=e("div",{class:"title"},"OTP",-1),M={key:0,class:"err-msg"},$={class:"remember-row flex align-center justify-space gap-16 mb-16"},G=e("label",{for:"check",class:"text-small flex align-center gap-10 pointer"},null,-1),K={key:0,class:"send-again"},Y={key:0,class:"code-msg"},q={class:"submit-btn"},z={key:0,type:"submit",class:"btn primary-btn w-100"},F={key:1,type:"submit",class:"btn primary-btn w-100"},H={class:"reg-row flex align-center gap-16"},J=e("div",{class:"text text-grey"},"Login Via Password",-1),Z={__name:"OtpLogin",setup(Q){k("");const a=O(),r=m(()=>a.state.Auth),t=w({submit:!1,submitOtp:!1,loginId:null,input1:null,input2:null,input3:null,input4:null,otp:"",time:30,timerRunning:!1,intervalId:null});x(()=>{r.value.otpStatus=!1});const h=()=>{if(console.log("Login ID:",t.loginId),r.value.otpStatus){if(c.value){t.submitOtp=!0;return}t.submitOtp=!1,a.dispatch("Auth/crmVerifyOtp",{loginId:t.loginId,otp:t.otp,roles:"ROOT"})}else{if(d.value){t.submit=!0;return}t.submit=!1,g(),a.dispatch("Auth/crmLogin",{loginId:t.loginId,password:null,roles:"ROOT",passwordStatus:!1})}};function b(){if(d.value){t.submit=!0;return}t.submit=!1,g(),a.dispatch("Auth/crmLogin",{loginId:t.loginId,password:null,roles:"ROOT",passwordStatus:!1})}function g(){t.timerRunning=!0,t.time=30,t.intervalId=setInterval(()=>{t.time>1?t.time--:(clearInterval(t.intervalId),t.timerRunning=!1)},1e3)}const d=m(()=>{if(!t.loginId)return"Please Enter Your Registered Phone Number"}),c=m(()=>{if(t.otp){if(t.otp.length!=4)return"Pleade Enter Valid OTP !"}else return"Please Enter OTP!"});function y(n){let s=String.fromCharCode(n.keyCode);if(/^[0-9]+$/.test(s)||n.keyCode===8||n.keyCode===9||n.keyCode===37||n.keyCode===39||n.keyCode>=96&&n.keyCode<=105)return!0;n.preventDefault()}return(n,s)=>{const I=S("router-link");return o(),i("div",R,[L,e("div",E,[e("form",{class:"form",onSubmit:C(h,["prevent"])},[N,e("div",D,[U,_(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=l=>t.loginId=l),placeholder:"Enter User Id",maxlength:"30"},null,512),[[f,t.loginId]]),t.submit&&d.value?(o(),i("div",A,p(d.value),1)):u("",!0)]),r.value.otpStatus?(o(),i("div",B,[j,_(e("input",{type:"text",name:"otp","onUpdate:modelValue":s[1]||(s[1]=l=>t.otp=l),placeholder:"Enter OTP",maxlength:"4",onKeydown:s[2]||(s[2]=l=>y(l))},null,544),[[f,t.otp]]),t.submit&&c.value?(o(),i("div",M,p(c.value),1)):u("",!0)])):u("",!0),e("div",$,[G,r.value.otpStatus?(o(),i("div",K,[v(" Didn't get it ? "),t.timerRunning?(o(),i("strong",Y,"Resend Code in "+p(t.time)+" Seconds",1)):(o(),i("strong",{key:1,class:"resend",onClick:s[3]||(s[3]=l=>b())},"Resend OTP"))])):u("",!0)]),e("div",q,[r.value.otpStatus?(o(),i("button",z," Sign In ")):(o(),i("button",F," Get Otp In "))])],32)]),e("div",H,[J,V(I,{to:"/login",class:"btn white-btn"},{default:T(()=>[v("Login")]),_:1})])])}}};export{Z as default};
