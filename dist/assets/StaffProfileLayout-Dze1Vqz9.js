import{k as F,u as x,s as R,x as E,d as B,e as P,n as V,l as j,r as p,o as n,c as a,a as t,j as f,t as I,b as o,g as r,f as m}from"./index-DwPljJjs.js";import{_ as D}from"./no-image-Cge9pZ0v.js";import{C as L}from"./cropper-DeyK3aZp.js";const q={class:"profile-layout"},N={class:"container"},W={class:"left-card card"},$={class:"top-info"},H=["src"],G={key:1,src:D,alt:""},J={class:"info"},K={class:"name"},Q=t("div",{class:"text"},"Welcome,",-1),T={class:"about f-w-bold"},X={class:"bottom-links bottom-links-desk"},Y=t("div",{class:"title"},"Profile",-1),Z={class:"icon"},ee=t("div",{class:"title"},"Students",-1),te={class:"icon"},oe=t("div",{class:"title"},"Department",-1),se={class:"icon"},ie=t("div",{class:"title"},"Subject",-1),ne={class:"icon"},ae=t("div",{class:"title"},"Documents",-1),ce={class:"icon"},le={class:"right-card card"},re=t("div",{class:"title",showHeader:"true"},"Upload Image",-1),de={class:"image-upload-crop"},pe={key:0},fe=["src"],_e=t("br",null,null,-1),ue=t("br",null,null,-1),ge={key:1},me=["src"],he={class:"modal-footer"},ve={class:"btns"},ye={__name:"StaffProfileLayout",setup(Ie){const h=F(null),d=x(),u=R();E();const _=B(()=>d.state.OrganizationStaff),e=P({staffAccountId:null,settingId:null,cropModal:!1,imageUrl:null,imageFile:null,croppedImageUrl:null,cropper:null,cropperEnable:!1,type:""});V(()=>{u.query.id&&(e.staffAccountId=u.query.id,e.settingId=u.query.settingId,S(),M())}),j(()=>{e.cropper&&e.cropper.destroy()});const b=()=>{e.cropper&&e.cropper.destroy(),e.cropperEnable=!1},k=()=>{e.cropper&&e.cropper.destroy(),e.cropperEnable=!0;const s=h.value;e.cropper=new L(s,{aspectRatio:1,viewMode:1})},C=s=>{e.imageFile=s.target.files[0],e.imageFile&&e.imageFile.type.startsWith("image/")&&(e.imageUrl=URL.createObjectURL(e.imageFile))},y=()=>{const s=e.cropper.getCroppedCanvas();e.croppedImageUrl=s.toDataURL()};async function w(){if(!e.cropperEnable)d.dispatch("OrganizationStaff/updateProfileImage",{id:e.staffAccountId,file:e.imageFile});else{const s=e.cropper.getCroppedCanvas(),i=await new Promise(l=>s.toBlob(l)),c=new File([i],"cropped-image.png",{type:"image/png"});d.dispatch("OrganizationStaff/updateProfileImage",{id:e.staffAccountId,file:c})}e.cropModal=!1}function U(){e.cropModal=!0}function S(){d.dispatch("OrganizationStaff/getOneStaff",{id:e.staffAccountId})}function M(){d.dispatch("OrganizationSettings/getOneOrganizationSettings",{id:e.settingId})}return(s,i)=>{var v;const c=p("icon-right-arrow"),l=p("router-link"),O=p("router-view"),A=p("icon-cross"),z=p("Modal");return n(),a("section",q,[t("div",N,[t("div",W,[t("div",$,[t("div",{class:"img",onClick:f(U,["prevent"])},[_.value.profile?(n(),a("img",{key:0,src:_.value.profile,alt:""},null,8,H)):(n(),a("img",G))]),t("div",J,[t("div",K,[Q,t("h3",null,I(_.value.name),1)]),t("div",T,I((v=_.value.designation)==null?void 0:v.name),1)])]),t("div",X,[o(l,{to:"/crm/college-staff-profile?id="+e.staffAccountId+"&settingId="+e.settingId,class:"profile-link"},{default:r(()=>[Y,t("div",Z,[o(c)])]),_:1},8,["to"]),o(l,{to:"/crm/college-staff-class-students?id="+e.staffAccountId+"&settingId="+e.settingId,class:"profile-link"},{default:r(()=>[ee,t("div",te,[o(c)])]),_:1},8,["to"]),o(l,{to:"/crm/college-staff-department?id="+e.staffAccountId+"&settingId="+e.settingId,class:"profile-link"},{default:r(()=>[oe,t("div",se,[o(c)])]),_:1},8,["to"]),o(l,{to:"/crm/college-staff-subject?id="+e.staffAccountId+"&settingId="+e.settingId,class:"profile-link"},{default:r(()=>[ie,t("div",ne,[o(c)])]),_:1},8,["to"]),o(l,{to:"/crm/college-staff-documents?id="+e.staffAccountId+"&settingId="+e.settingId,class:"profile-link"},{default:r(()=>[ae,t("div",ce,[o(c)])]),_:1},8,["to"])])]),t("div",le,[o(O)])]),o(z,{show:e.cropModal,"onUpdate:show":i[2]||(i[2]=g=>e.cropModal=g),class:"status-modal",headerClasses:"header-bg"},{header:r(()=>[re,t("div",{class:"close-btn",onClick:i[0]||(i[0]=f(g=>e.cropModal=!1,["prevent"]))},[o(A)])]),default:r(()=>[t("div",de,[t("input",{type:"file",onChange:C},null,32),e.imageUrl?(n(),a("div",pe,[t("img",{ref_key:"imageRef",ref:h,src:e.imageUrl,alt:"Source Image",style:{"max-width":"100%"}},null,8,fe),_e,e.cropperEnable?(n(),a("button",{key:0,type:"button",class:"btn green-btn",onClick:y}," Crop Image ")):m("",!0),ue])):m("",!0),e.croppedImageUrl?(n(),a("div",ge,[t("img",{src:e.croppedImageUrl,alt:"Cropped Image",style:{"max-width":"100%",height:"150px"}},null,8,me)])):m("",!0)]),t("div",he,[t("div",ve,[t("div",{class:"btn red-btn",onClick:i[1]||(i[1]=f(g=>e.cropModal=!1,["prevent"]))}," Cancel "),e.cropperEnable?(n(),a("div",{key:1,class:"btn green-btn",onClick:f(b,["prevent"])}," Crop ")):(n(),a("div",{key:0,class:"btn green-btn",onClick:f(k,["prevent"])}," Crop ")),t("div",{class:"btn white-btn",onClick:w},"Upload")])])]),_:1},8,["show"])])}}};export{ye as default};
