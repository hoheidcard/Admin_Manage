import{u as m,s as v,k as S,x as y,d as z,e as b,n as w,l as x,r as I,o as l,c as p,a as t,b as C,i as d,I as P,t as O,f as V,j as U}from"./index-DwPljJjs.js";const k={class:"section import-page"},B={class:"container"},D={class:"main-card mid-cardd"},F={class:"card-header"},j={class:"left"},N={class:"icon"},A=t("div",{class:"right"},[t("div",{class:"text text-grey"})],-1),R={class:"card-body flex justify-center"},q={class:"import-data flex flex-d-col align-center text-center w-90 p-6-r"},L={key:0,class:"cssProgress"},M={class:"progress3"},T=["data-percent"],E={class:"cssProgress-label"},H=t("h4",{class:"mb-16"},"Import Students Data",-1),J={class:"text text-grey mb-16 w-50"},W={for:"list",class:"flex justify-center"},Z=t("div",{class:"btn white-btn"},"Upload ZIP File",-1),Q={__name:"Import",setup(G){const n=m(),r=v();S([]),y();const c=z(()=>n.state.OrganizationSettings),e=b({submit:!1,organizationId:null,organizationSettingId:null,file:null,uploadPercentage:0,progressStatus:!1});w(()=>{r.query.id&&(e.organizationId=r.query.id,e.organizationSettingId=r.query.settingId,u())}),x(()=>{e.progressStatus=!1,e.uploadPercentage=0});function u(){n.dispatch("OrganizationSettings/getOneOrganizationSettings",{id:e.organizationSettingId})}const g=s=>{e.uploadPercentage=Math.round(s.loaded*100/s.total)};async function f(s){if(s){e.progressStatus=!1,e.uploadPercentage=0;const o=s.target.files[0];if(o.type.endsWith("zip")||o.type==="application/x-zip-compressed"){const i=new FormData;i.append("file",o),e.progressStatus=!0,n.dispatch("OrganizationStudent/uploadStudentCsvFile",{organizationDetailId:e.organizationId,settingId:e.organizationSettingId,files:i,onUploadProgress:g,type:"SCHOOL"}),s.target.value=null}else n.dispatch("Alert/error",{msg:"Upload file in zip format."})}else n.dispatch("Alert/error",{msg:"Upload file in zip format."})}const _=s=>s.join(",")+`
`,h=()=>{if(c.value.studentCsvFields){const s=_(JSON.parse(c.value.studentCsvFields)),o=new Blob([s],{type:"text/csv"}),i=window.URL.createObjectURL(o),a=document.createElement("a");a.href=i,a.setAttribute("download","data.csv"),document.body.appendChild(a),a.click(),document.body.removeChild(a)}else n.dispatch("Alert/error",{msg:"Please select csv fields from setting."})};return(s,o)=>{const i=I("icon-download");return l(),p("div",k,[t("div",B,[t("div",D,[t("div",F,[t("div",j,[t("div",N,[C(i,{class:"rotate-18"})]),d(" Import Students ")]),A]),t("div",R,[t("div",q,[e.progressStatus?(l(),p("div",L,[t("div",M,[t("div",{class:"cssProgress-bar cssProgress-active","data-percent":e.uploadPercentage,style:P({width:e.uploadPercentage+"%"})},[t("span",E,O(e.uploadPercentage)+"%",1)],12,T)])])):V("",!0),H,t("div",J,[d(" If the university or school is aware of these cases, they can monitor the "),t("a",{class:"text-primary text-small f-w-bold pointer",onClick:U(h,["prevent"])},"Download CSV File"),d(" & Upload it where threats found ")]),t("label",W,[t("input",{type:"file",id:"list",class:"d-none",accept:".zip",onChange:o[0]||(o[0]=a=>f(a))},null,32),Z])])])])])])}}};export{Q as default};
